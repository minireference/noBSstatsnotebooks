
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Chapter 4: Linear models &#8212; No BS Stats Notebooks</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 1 — Data" href="../notebooks/10_DATA.html" />
    <link rel="prev" title="Chapter 3: Inferential statistics" href="03_STATS.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">No BS Stats Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    No Bullshit Stats Notebooks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="00_Introduction.html">
   Statistics overview
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_DATA.html">
     Chapter 1: DATA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_PROB.html">
     Chapter 2: Probability theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_STATS.html">
     Chapter 3: Inferential statistics
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Chapter 4: Linear models
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../notebooks/10_DATA.html">
   Chapter 1 — Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../notebooks/11_intro_to_data.html">
     Section 1.1 — Introduction to data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notebooks/12_data_in_practice.html">
     Section 1.2 — Data in practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../notebooks/13_descriptive_statistics.html">
     Section 1.3 — Descriptive statistics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../notebooks/20_PROB.html">
   Chapter 2 — Probability theory
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/30_STATS.html">
   Chapter 3 — Inferential statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../notebooks/40_LINEAR_MODELS.html">
   Chapter 4 — Linear models
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/appendix.html">
   Appendix
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/python_tutorial.html">
     Appendix C — Python tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/pandas_tutorial.html">
     Appendix D — Pandas tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/seaborn_tutorial.html">
     Appendix E — Seaborn tutorial
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/minireference/noBSstatsnotebooks/main?urlpath=tree/./stats_overview/04_LINEAR_MODELS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/minireference/noBSstatsnotebooks"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/minireference/noBSstatsnotebooks/issues/new?title=Issue%20on%20page%20%2Fstats_overview/04_LINEAR_MODELS.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/stats_overview/04_LINEAR_MODELS.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook-setup">
   Notebook setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-models-for-relationship-between-two-numeric-variables">
   4.1 Linear models for relationship between two numeric variables
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#new-dataset">
     New dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#types-of-linear-relationship-between-input-and-output">
       Types of linear relationship between input and output
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-linear-models">
   4.2 Fitting linear models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-statsmodels-formula-api">
     Using statsmodels formula API
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#alternative-model-fitting-methods">
     Alternative model fitting methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-pre-processing">
       Data pre-processing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fit-using-statsmodels-ols">
       2. fit using statsmodels OLS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solution-using-linregress-from-scipy">
       3. solution using
       <code class="docutils literal notranslate">
        <span class="pre">
         linregress
        </span>
       </code>
       from
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-an-optimization-approach">
       4. Using an optimization approach
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linear-algebra-solution">
       5. Linear algebra solution
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-scikit-learn">
       Using scikit-learn
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpreting-linear-models">
   4.3 Interpreting linear models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpreting-the-results">
     Interpreting the results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-parameters">
     Model parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-r-2-coefficient-of-determination">
     The
     <span class="math notranslate nohighlight">
      \(R^2\)
     </span>
     coefficient of determination
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hypothesis-testing-for-slope-coefficient">
     Hypothesis testing for slope coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predictions-using-the-model">
     Predictions using the model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion">
   Discussion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#next-steps">
     Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Chapter 4: Linear models</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook-setup">
   Notebook setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-models-for-relationship-between-two-numeric-variables">
   4.1 Linear models for relationship between two numeric variables
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#new-dataset">
     New dataset
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#types-of-linear-relationship-between-input-and-output">
       Types of linear relationship between input and output
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-linear-models">
   4.2 Fitting linear models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-statsmodels-formula-api">
     Using statsmodels formula API
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#alternative-model-fitting-methods">
     Alternative model fitting methods
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#data-pre-processing">
       Data pre-processing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fit-using-statsmodels-ols">
       2. fit using statsmodels OLS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#solution-using-linregress-from-scipy">
       3. solution using
       <code class="docutils literal notranslate">
        <span class="pre">
         linregress
        </span>
       </code>
       from
       <code class="docutils literal notranslate">
        <span class="pre">
         scipy
        </span>
       </code>
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-an-optimization-approach">
       4. Using an optimization approach
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linear-algebra-solution">
       5. Linear algebra solution
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#using-scikit-learn">
       Using scikit-learn
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpreting-linear-models">
   4.3 Interpreting linear models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpreting-the-results">
     Interpreting the results
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-parameters">
     Model parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-r-2-coefficient-of-determination">
     The
     <span class="math notranslate nohighlight">
      \(R^2\)
     </span>
     coefficient of determination
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hypothesis-testing-for-slope-coefficient">
     Hypothesis testing for slope coefficient
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predictions-using-the-model">
     Predictions using the model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion">
   Discussion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#next-steps">
     Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-4-linear-models">
<h1>Chapter 4: Linear models<a class="headerlink" href="#chapter-4-linear-models" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://docs.google.com/document/d/1fwep23-95U-w1QMPU31nOvUnUXE2X3s_Dbk5JuLlKAY/edit#heading=h.9etj7aw4al9w">Link to outline</a></p>
<p>Concept map:
<img alt="concepts_LINEARMODELS.png" src="stats_overview/attachment:c335ebb2-f116-486c-8737-22e517de3146.png" /></p>
<section id="notebook-setup">
<h2>Notebook setup<a class="headerlink" href="#notebook-setup" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">norm</span>


<span class="c1"># notebooks figs setup</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">)})</span>
<span class="n">blue</span><span class="p">,</span> <span class="n">orange</span>  <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># silence annoying warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="linear-models-for-relationship-between-two-numeric-variables">
<h2>4.1 Linear models for relationship between two numeric variables<a class="headerlink" href="#linear-models-for-relationship-between-two-numeric-variables" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>def’n linear model: <strong>y ~ m*x + b</strong>, a.k.a. linear regression</p></li>
<li><p>Amy has collected a new dataset:</p>
<ul>
<li><p>Instead of receiving a fixed amount of stats training (100 hours),
<strong>each employee now receives a variable amount of stats training (anywhere from 0 hours to 100 hours)</strong></p></li>
<li><p>Amy has collected ELV values after one year as previously</p></li>
<li><p>Goal find best fit line for relationship <span class="math notranslate nohighlight">\(\textrm{ELV} \sim \beta_0 + \beta_1\!*\!\textrm{hours}\)</span></p></li>
</ul>
</li>
<li><p>Limitation: <strong>we assume the change in ELV is proportional to number of hours</strong> (i.e. linear relationship).
Other types of hours-ELV relationship possible, but we will not be able to model them correctly (see figure below).</p></li>
</ul>
<section id="new-dataset">
<h3>New dataset<a class="headerlink" href="#new-dataset" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">hours</span></code> column contains the <code class="docutils literal notranslate"><span class="pre">x</span></code> values (how many hours of statistics training did the employee receive),</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ELV</span></code> column contains the <code class="docutils literal notranslate"><span class="pre">y</span></code> values (the employee ELV after one year)</p></li>
</ul>
<p><img alt="excel_file_for_linear_models.png" src="stats_overview/attachment:71dfeb87-78ec-4523-94fa-7df9a6db4aec.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data into a pandas dataframe</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;data/ELV_vs_hours.ods&quot;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
<span class="c1"># df2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hours</th>
      <th>ELV</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>33.000000</td>
      <td>33.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>57.909091</td>
      <td>1154.046364</td>
    </tr>
    <tr>
      <th>std</th>
      <td>28.853470</td>
      <td>123.055405</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.000000</td>
      <td>929.200000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>35.000000</td>
      <td>1062.210000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>65.000000</td>
      <td>1163.890000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>83.000000</td>
      <td>1253.620000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>99.000000</td>
      <td>1384.480000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot ELV vs. hours data</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;hours&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ELV&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;hours&#39;, ylabel=&#39;ELV&#39;&gt;
</pre></div>
</div>
<img alt="../_images/04_LINEAR_MODELS_7_1.png" src="../_images/04_LINEAR_MODELS_7_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># linear model plot (preview)</span>
<span class="c1"># sns.lmplot(x=&#39;hours&#39;, y=&#39;ELV&#39;, data=df2, ci=False)</span>
</pre></div>
</div>
</div>
</div>
<section id="types-of-linear-relationship-between-input-and-output">
<h4>Types of linear relationship between input and output<a class="headerlink" href="#types-of-linear-relationship-between-input-and-output" title="Permalink to this headline">#</a></h4>
<p>Different possible relationships between the number of hours of stats training and ELV gains:</p>
<p><img alt="figures/ELV_as_function_of_stats_hours.png" src="../_images/ELV_as_function_of_stats_hours.png" /></p>
</section>
</section>
</section>
<section id="fitting-linear-models">
<h2>4.2 Fitting linear models<a class="headerlink" href="#fitting-linear-models" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Main idea: use <code class="docutils literal notranslate"><span class="pre">fit</span></code> method from <code class="docutils literal notranslate"><span class="pre">statsmodels.ols</span></code> and a formula (approach 1)</p></li>
<li><p>Visual inspection</p></li>
<li><p>Results of linear model fit are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">beta0</span></code> = <span class="math notranslate nohighlight">\(\beta_0\)</span> = baseline ELV (y-intercept)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">beta1</span></code> = <span class="math notranslate nohighlight">\(\beta_1\)</span> = increase in ELV for each additional hour of stats training (slope)</p></li>
</ul>
</li>
<li><p>Five more alternative fitting methods (bonus material):
2. fit using statsmodels <code class="docutils literal notranslate"><span class="pre">OLS</span></code>
3. solution using <code class="docutils literal notranslate"><span class="pre">linregress</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy</span></code>
4. solution using <code class="docutils literal notranslate"><span class="pre">optimize</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy</span></code>
5. linear algebra solution using <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
6. solution using <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> model from scikit-learn</p></li>
</ul>
<section id="using-statsmodels-formula-api">
<h3>Using statsmodels formula API<a class="headerlink" href="#using-statsmodels-formula-api" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> Python library offers a convenient way to specify statistics model as a “formula”  that describes the relationship we’re looking for.</p>
<p>Mathematically, the linear model is written:</p>
<p><span class="math notranslate nohighlight">\(\large \textrm{ELV} \ \ \sim \ \ \beta_0\cdot 1 \ + \ \beta_1\cdot\textrm{hours}\)</span></p>
<p>and the formula is:</p>
<p><code class="docutils literal notranslate"><span class="pre">ELV</span>&#160;&#160;&#160; <span class="pre">~</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span>&#160; <span class="pre">+</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">hours</span></code></p>
<p>Note the variables <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span> are omitted, since the whole point of fitting a linear model is to find these coefficients. The parameters of the model are:</p>
<ul class="simple">
<li><p>Instead of <span class="math notranslate nohighlight">\(\beta_0\)</span>, the constant parameter will be called <code class="docutils literal notranslate"><span class="pre">Intercept</span></code></p></li>
<li><p>Instead of a new name <span class="math notranslate nohighlight">\(\beta_1\)</span>, we’ll call it <code class="docutils literal notranslate"><span class="pre">hours</span></code> coefficient (i.e. the coefficient associated with the <code class="docutils literal notranslate"><span class="pre">hours</span></code> variable in the model)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;ELV ~ 1 + hours&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extact the best-fit model parameters</span>
<span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span>
<span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1005.6736305656403, 2.562166505145919)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data points</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;hours&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ELV&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>

<span class="c1"># linear model for data</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>   <span class="c1"># input = hours</span>
<span class="n">ymodel</span> <span class="o">=</span> <span class="n">beta0</span> <span class="o">+</span> <span class="n">beta1</span><span class="o">*</span><span class="n">x</span>  <span class="c1"># output = ELV</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ymodel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;hours&#39;, ylabel=&#39;ELV&#39;&gt;
</pre></div>
</div>
<img alt="../_images/04_LINEAR_MODELS_14_1.png" src="../_images/04_LINEAR_MODELS_14_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>ELV</td>       <th>  R-squared:         </th> <td>   0.361</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.340</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   17.51</td>
</tr>
<tr>
  <th>Date:</th>             <td>Sat, 16 Jul 2022</td> <th>  Prob (F-statistic):</th> <td>0.000218</td>
</tr>
<tr>
  <th>Time:</th>                 <td>21:53:56</td>     <th>  Log-Likelihood:    </th> <td> -197.75</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    33</td>      <th>  AIC:               </th> <td>   399.5</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    31</td>      <th>  BIC:               </th> <td>   402.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td> 1005.6736</td> <td>   39.499</td> <td>   25.461</td> <td> 0.000</td> <td>  925.115</td> <td> 1086.232</td>
</tr>
<tr>
  <th>hours</th>     <td>    2.5622</td> <td>    0.612</td> <td>    4.184</td> <td> 0.000</td> <td>    1.313</td> <td>    3.811</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.012</td> <th>  Durbin-Watson:     </th> <td>   2.135</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.135</td> <th>  Jarque-Bera (JB):  </th> <td>   2.166</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.368</td> <th>  Prob(JB):          </th> <td>   0.339</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.983</td> <th>  Cond. No.          </th> <td>    146.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
</section>
<section id="alternative-model-fitting-methods">
<h3>Alternative model fitting methods<a class="headerlink" href="#alternative-model-fitting-methods" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>fit using statsmodels <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLS.html"><code class="docutils literal notranslate"><span class="pre">OLS</span></code></a></p></li>
<li><p>solution using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.linregress.html"><code class="docutils literal notranslate"><span class="pre">linregress</span></code></a> from <code class="docutils literal notranslate"><span class="pre">scipy</span></code></p></li>
<li><p>solution using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html"><code class="docutils literal notranslate"><span class="pre">minimize</span></code></a> from <code class="docutils literal notranslate"><span class="pre">scipy</span></code></p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/routines.linalg.html">linear algebra</a> solution using <code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></li>
<li><p>solution using <a class="reference external" href="https://scikit-learn.org/stable/modules/linear_model.html#ordinary-least-squares"><code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code></a> model from scikit-learn</p></li>
</ol>
<section id="data-pre-processing">
<h4>Data pre-processing<a class="headerlink" href="#data-pre-processing" title="Permalink to this headline">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> formula <code class="docutils literal notranslate"><span class="pre">ols</span></code> approach we used above was able to get the data
directly from the dataframe <code class="docutils literal notranslate"><span class="pre">df2</span></code>, but some of the other model fitting methods
require data to be provided as regular arrays: the x-values and the y-values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract hours and ELV data from df2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;hours&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># hours data as an array</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;ELV&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>    <span class="c1"># ELV data as an array</span>

<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="c1"># x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((33,), (33,))
</pre></div>
</div>
</div>
</div>
<p>Two of the approaches required “packaging” the x-values along with a column of ones,
to form a matrix (called a design matrix). Luckily <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> provides a convenient function for this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="c1"># add a column of ones to the x data</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="c1"># X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(33, 2)
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="fit-using-statsmodels-ols">
<h4>2. fit using statsmodels OLS<a class="headerlink" href="#fit-using-statsmodels-ols" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="c1"># result2.summary()</span>
<span class="n">result2</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1005.67363057,    2.56216651])
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="solution-using-linregress-from-scipy">
<h4>3. solution using <code class="docutils literal notranslate"><span class="pre">linregress</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy</span></code><a class="headerlink" href="#solution-using-linregress-from-scipy" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>

<span class="n">result3</span> <span class="o">=</span> <span class="n">linregress</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">result3</span><span class="o">.</span><span class="n">intercept</span><span class="p">,</span> <span class="n">result3</span><span class="o">.</span><span class="n">slope</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1005.6736305656411, 2.562166505145915)
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="using-an-optimization-approach">
<h4>4. Using an optimization approach<a class="headerlink" href="#using-an-optimization-approach" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the sum-of-squared-errors objective function.&quot;&quot;&quot;</span>
    <span class="n">sumse</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">yi_pred</span> <span class="o">=</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">xi</span>
        <span class="n">ei</span> <span class="o">=</span> <span class="p">(</span><span class="n">yi_pred</span><span class="o">-</span><span class="n">yi</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">sumse</span> <span class="o">+=</span> <span class="n">ei</span>
    <span class="k">return</span> <span class="n">sumse</span>

<span class="n">result4</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">sse</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span> <span class="o">=</span> <span class="n">result4</span><span class="o">.</span><span class="n">x</span>
<span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1005.6735312616879, 2.5621679129172805)
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="linear-algebra-solution">
<h4>5. Linear algebra solution<a class="headerlink" href="#linear-algebra-solution" title="Permalink to this headline">#</a></h4>
<p>We obtain the least squares solution using the Moore–Penrose inverse formula:
$<span class="math notranslate nohighlight">\( \large
    \vec{\beta} = (X^{\sf T} X)^{-1}X^{\sf T}\; \vec{y}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5. linear algebra solution using `numpy`</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">result5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span> <span class="o">=</span> <span class="n">result5</span>
<span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1005.6736305656412, 2.562166505145917)
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="using-scikit-learn">
<h4>Using scikit-learn<a class="headerlink" href="#using-scikit-learn" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 6. solution using `LinearRegression` from scikit-learn</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="n">model6</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model6</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>
<span class="n">model6</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">model6</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1005.673630565641, array([2.56216651]))
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="interpreting-linear-models">
<h2>4.3 Interpreting linear models<a class="headerlink" href="#interpreting-linear-models" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>model fit checks</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(R^2\)</span> <a class="reference external" href="https://en.wikipedia.org/wiki/Coefficient_of_determination">coefficient of determination</a>
= the proportion of the variation in the dependent variable that is predictable from the independent variable</p></li>
<li><p>plot of residuals</p></li>
<li><p>many other: see <a class="reference external" href="https://scikit-learn.org/stable/modules/model_evaluation.html#regression-metrics">scikit docs</a></p></li>
</ul>
</li>
<li><p>hypothesis tests</p>
<ul>
<li><p>is slope zero or nonzero? (and CI interval)</p></li>
<li><p>caution: cannot make any cause-and-effect claims; only a correlation</p></li>
</ul>
</li>
<li><p>Predictions</p>
<ul>
<li><p>given best-fir model obtained from data, we can make predictions (interpolations),<br />
e.g., what is the expected ELV after 50 hours of stats training?</p></li>
</ul>
</li>
</ul>
<section id="interpreting-the-results">
<h3>Interpreting the results<a class="headerlink" href="#interpreting-the-results" title="Permalink to this headline">#</a></h3>
<p>Let’s review some of the other data included in the <code class="docutils literal notranslate"><span class="pre">results.summary()</span></code> report for the linear model fit we did earlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>           <td>ELV</td>       <th>  R-squared:         </th> <td>   0.361</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.340</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   17.51</td>
</tr>
<tr>
  <th>Date:</th>             <td>Sat, 16 Jul 2022</td> <th>  Prob (F-statistic):</th> <td>0.000218</td>
</tr>
<tr>
  <th>Time:</th>                 <td>21:53:56</td>     <th>  Log-Likelihood:    </th> <td> -197.75</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    33</td>      <th>  AIC:               </th> <td>   399.5</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    31</td>      <th>  BIC:               </th> <td>   402.5</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td> 1005.6736</td> <td>   39.499</td> <td>   25.461</td> <td> 0.000</td> <td>  925.115</td> <td> 1086.232</td>
</tr>
<tr>
  <th>hours</th>     <td>    2.5622</td> <td>    0.612</td> <td>    4.184</td> <td> 0.000</td> <td>    1.313</td> <td>    3.811</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.012</td> <th>  Durbin-Watson:     </th> <td>   2.135</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.135</td> <th>  Jarque-Bera (JB):  </th> <td>   2.166</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.368</td> <th>  Prob(JB):          </th> <td>   0.339</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.983</td> <th>  Cond. No.          </th> <td>    146.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
</section>
<section id="model-parameters">
<h3>Model parameters<a class="headerlink" href="#model-parameters" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span>
<span class="n">result</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    1005.673631
hours           2.562167
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-r-2-coefficient-of-determination">
<h3>The <span class="math notranslate nohighlight">\(R^2\)</span> coefficient of determination<a class="headerlink" href="#the-r-2-coefficient-of-determination" title="Permalink to this headline">#</a></h3>
<p><span class="math notranslate nohighlight">\(R^2 = 1\)</span> corresponds to perfect prediction</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">rsquared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.36091871798872777
</pre></div>
</div>
</div>
</div>
</section>
<section id="hypothesis-testing-for-slope-coefficient">
<h3>Hypothesis testing for slope coefficient<a class="headerlink" href="#hypothesis-testing-for-slope-coefficient" title="Permalink to this headline">#</a></h3>
<p>Is there a non-zero slope coefficient?</p>
<ul class="simple">
<li><p><strong>null hypothesis <span class="math notranslate nohighlight">\(H_0\)</span></strong>: <code class="docutils literal notranslate"><span class="pre">hours</span></code> has no effect on <code class="docutils literal notranslate"><span class="pre">ELV</span></code>,
which is equivalent to <span class="math notranslate nohighlight">\(\beta_1 = 0\)</span>:
$<span class="math notranslate nohighlight">\( \large
   H_0: \qquad \textrm{ELV} \sim \mathcal{N}(\color{red}{\beta_0}, \sigma^2) \qquad \qquad \qquad
\)</span>$</p></li>
<li><p><strong>alternative hypothesis <span class="math notranslate nohighlight">\(H_A\)</span></strong>: <code class="docutils literal notranslate"><span class="pre">hours</span></code> has an effect on <code class="docutils literal notranslate"><span class="pre">ELV</span></code>,
and the slope is not zero, <span class="math notranslate nohighlight">\(\beta_1 \neq 0\)</span>:
$<span class="math notranslate nohighlight">\( \large
   H_A: \qquad \textrm{ELV} 
               \sim
               \mathcal{N}\left(
                   \color{blue}{\beta_0 + \beta_1\!\cdot\!\textrm{hours}},
                   \ \sigma^2
               \right)
\)</span>$</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># p-value under the null hypotheis of zero slope or &quot;no effect of `hours` on `ELV`&quot;</span>
<span class="n">result</span><span class="o">.</span><span class="n">pvalues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;hours&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.00021840378059913016
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 95% confidence interval for the hours-slope parameter</span>
<span class="c1"># result.conf_int()</span>
<span class="n">CI_hours</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;hours&#39;</span><span class="p">])</span>
<span class="n">CI_hours</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.313270083442885, 3.811062926848953]
</pre></div>
</div>
</div>
</div>
</section>
<section id="predictions-using-the-model">
<h3>Predictions using the model<a class="headerlink" href="#predictions-using-the-model" title="Permalink to this headline">#</a></h3>
<p>We can use the model we obtained to predict (interpolate) the ELV for future employees.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;hours&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ELV&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>
<span class="n">ymodel</span> <span class="o">=</span> <span class="n">beta0</span> <span class="o">+</span> <span class="n">beta1</span><span class="o">*</span><span class="n">x</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ymodel</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;hours&#39;, ylabel=&#39;ELV&#39;&gt;
</pre></div>
</div>
<img alt="../_images/04_LINEAR_MODELS_48_1.png" src="../_images/04_LINEAR_MODELS_48_1.png" />
</div>
</div>
<p>What ELV can we expect from a new employee that takes 50 hours of stats training?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s1">&#39;hours&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1133.781956
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s1">&#39;hours&#39;</span><span class="p">:[</span><span class="mi">100</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1261.890281
dtype: float64
</pre></div>
</div>
</div>
</div>
<p><strong>WARNING</strong>: it’s not OK to extrapolate the validity of the model outside of the range of values where we have observed data.</p>
<p>For example, there is no reason to believe in the model’s predictions about ELV for 200 or 2000 hours of stats training:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">predict</span><span class="p">({</span><span class="s1">&#39;hours&#39;</span><span class="p">:[</span><span class="mi">200</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    1518.106932
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Permalink to this headline">#</a></h2>
<p>Further topics that will be covered in the book:</p>
<ul class="simple">
<li><p>Generalized linear models, e.g., <a class="reference external" href="https://en.wikipedia.org/wiki/Logistic_regression">Logistic regression</a></p></li>
<li><p><a class="reference external" href="https://www.eigenfoo.xyz/tests-as-linear/">Everything is a linear model</a> article</p></li>
<li><p>The verbs <code class="docutils literal notranslate"><span class="pre">fit</span></code> and <code class="docutils literal notranslate"><span class="pre">predict</span></code> will come up A LOT in machine learning,<br />
so it’s worth learning linear models in detail to be prepared for further studies.</p></li>
</ul>
<hr class="docutils" />
<p>Congratulations on completing this overview of statistics! We covered a lot of topics and core ideas from the book. I know some parts seemed kind of complicated at first, but if you think about them a little you’ll see there is nothing too difficult to learn. The good news is that the examples in these notebooks contain all the core ideas, and you won’t be exposed to anything more complicated that what you saw here!</p>
<p>If you were able to handle these notebooks, you’ll be able to handle the <strong>No Bullshit Guide to Statistics</strong> too! In fact the book will cover the topics in a much smoother way, and with better explanations. You’ll have a lot of exercises and problems to help you practice statistical analysis.</p>
<section id="next-steps">
<h3>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>I encourage you to check out the <a class="reference external" href="https://docs.google.com/document/d/1fwep23-95U-w1QMPU31nOvUnUXE2X3s_Dbk5JuLlKAY/edit">book outline shared gdoc</a> if you haven’t seen it already. Please leave me a comment in the google document if you see something you don’t like in the outline, or if you think some important statistics topics are missing. You can also read the <a class="reference external" href="https://minireference.com/blog/no-bullshit-guide-to-statistics-progress-update/">book proposal blog post</a> for more info about the book.</p></li>
<li><p>Check out also the <a class="reference external" href="https://minireference.com/static/excerpts/noBSstats/conceptmaps/BookSubjectsOverview.pdf">concept map</a>. You can print it out and annotate with the concepts you heard about in these notebooks.</p></li>
<li><p>If you want to be involved in the stats book in the coming months, sign up to the <a class="reference external" href="https://confirmsubscription.com/h/t/A17516BF2FCB41B2">stats reviewers mailing list</a> to receive chapter drafts as they are being prepared (Nov+Dec 2021). I’ll appreciate your feedback on the text. The goal is to have the book finished in the Spring 2022, and feedback and “user testing” will be very helpful.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "minireference/noBSstatsnotebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./stats_overview"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="03_STATS.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Chapter 3: Inferential statistics</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../notebooks/10_DATA.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 1 — Data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ivan Savov<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>