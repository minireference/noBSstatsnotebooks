
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Section 2.1 — Probability theory &#8212; No BS Stats Notebooks</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">No BS Stats Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   No Bullshit Stats Notebooks
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../stats_overview/00_Introduction.html">
   Statistics overview
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../stats_overview/01_DATA.html">
     Chapter 1: DATA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../stats_overview/02_PROB.html">
     Chapter 2: Probability theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../stats_overview/03_STATS.html">
     Chapter 3: Inferential statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../stats_overview/04_LINEAR_MODELS.html">
     Chapter 4: Linear models
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="10_data.html">
   Chapter 1 — Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="11_intro_to_data.html">
     Section 1.1 — Introduction to data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="12_data_in_practice.html">
     Section 1.2 — Data in practice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="13_descriptive_statistics.html">
     Section 1.3 — Descriptive statistics
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/appendix.html">
   Appendix
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/python_tutorial.html">
     Appendix C — Python tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/pandas_tutorial.html">
     Appendix D — Pandas tutorial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/seaborn_tutorial.html">
     Appendix E — Seaborn tutorial
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/21_prob_theory.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/minireference/noBSstatsnotebooks"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/minireference/noBSstatsnotebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/21_prob_theory.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/minireference/noBSstatsnotebooks/main?urlpath=tree/./notebooks/21_prob_theory.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Section 2.1 — Probability theory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notebook-setup">
     Notebook setup
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-probability-theory">
     What is probability theory?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-do-we-need-probability-theory-in-statistics">
     Why do we need probability theory in statistics?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#definitions">
     Definitions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#random-variables">
       Random variables
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-1-uniform-distribution">
         Example 1: Uniform distribution
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-2-normal-distribution">
         Example 2: Normal distribution
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-3-coin-flip">
         Example 3: Coin flip
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-4-rolling-a-six-sided-die">
         Example 4: Rolling a six-sided die
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculus-prerequisites">
     Calculus prerequisites
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sets">
       Sets
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#functions">
       Functions
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#plotting-the-graph-of-the-function">
         Plotting the graph of the function
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#maybe-cut">
         MAYBE CUT
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-integrals-geometrically">
       Computing integrals geometrically
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-integrals-numerically-using-scipy-integrate-methods">
       Computing integrals numerically using SciPy
       <code class="docutils literal notranslate">
        <span class="pre">
         integrate
        </span>
       </code>
       methods
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maybe-cut-or-restructure-because-used-before-defined">
       MAYBE CUT OR RESTRUCTURE BECAUSE USED-BEFORE-DEFINED
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#uniform">
         Uniform
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#normal">
         Normal
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-integrals-symbolically-using-sympy-integrate">
       Computing integrals symbolically using SymPy
       <code class="docutils literal notranslate">
        <span class="pre">
         integrate
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#constant-function-f-x-c">
         Constant function
         <span class="math notranslate nohighlight">
          \(f(x)=c\)
         </span>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#line-g-x-x">
         Line
         <span class="math notranslate nohighlight">
          \(g(x)=x\)
         </span>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculations-with-random-variables">
     Calculations with random variables
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-1-mean-and-variance-of-the-uniform-distribution">
       Example 1: mean and variance of the uniform distribution
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#mean">
         Mean
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#variance">
         Variance
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-2-mean-and-variance-of-a-normal-distribution">
       Example 2: mean and variance of a normal distribution
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probability-models">
     Probability models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computer-models-for-random-variables">
     Computer models for random variables
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-the-probability-functions">
       Plotting the probability functions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#properties-of-the-distribution">
       Properties of the distribution
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-probabilities">
       Computing probabilities
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-quantiles">
       Computing quantiles
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#left-tail">
         Left tail
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#right-tail">
         Right tail
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#computing-confidence-intervals">
         Computing confidence intervals
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generating-random-observations">
       Generating random observations
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-expectations">
       Computing expectations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#discussion">
     Discussion
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#theoretical-calculus-topics">
       Theoretical calculus topics
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#limits">
         Limits
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#derivatives">
         Derivatives
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#optimization-algorithms">
         Optimization algorithms
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#using-scipy-optimization-functions">
         Using SciPy optimization functions
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#riemann-sums">
         Riemann sums
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#fundamental-theorem-of-calculus">
         Fundamental theorem of calculus
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bulk-of-the-distribution">
       Bulk of the distribution
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tails-of-the-distribution">
       Tails of the distribution
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figures-gen">
   FIGURES GEN
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cut-material">
   CUT MATERIAL
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-probability-calculation">
     Example probability calculation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cumulative-density-function-cdf">
     Cumulative density function (CDF)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-inverse-cdf-function">
     The inverse-CDF function
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#early-attempts-at-expectations-calculations">
       EARLY ATTEMPTS AT EXPECTATIONS CALCULATIONS
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#alt">
       Alt
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Section 2.1 — Probability theory</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Section 2.1 — Probability theory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notebook-setup">
     Notebook setup
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-probability-theory">
     What is probability theory?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-do-we-need-probability-theory-in-statistics">
     Why do we need probability theory in statistics?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#definitions">
     Definitions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#random-variables">
       Random variables
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-1-uniform-distribution">
         Example 1: Uniform distribution
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-2-normal-distribution">
         Example 2: Normal distribution
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-3-coin-flip">
         Example 3: Coin flip
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#example-4-rolling-a-six-sided-die">
         Example 4: Rolling a six-sided die
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculus-prerequisites">
     Calculus prerequisites
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sets">
       Sets
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#functions">
       Functions
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#plotting-the-graph-of-the-function">
         Plotting the graph of the function
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#maybe-cut">
         MAYBE CUT
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-integrals-geometrically">
       Computing integrals geometrically
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-integrals-numerically-using-scipy-integrate-methods">
       Computing integrals numerically using SciPy
       <code class="docutils literal notranslate">
        <span class="pre">
         integrate
        </span>
       </code>
       methods
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#maybe-cut-or-restructure-because-used-before-defined">
       MAYBE CUT OR RESTRUCTURE BECAUSE USED-BEFORE-DEFINED
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#uniform">
         Uniform
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#normal">
         Normal
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-integrals-symbolically-using-sympy-integrate">
       Computing integrals symbolically using SymPy
       <code class="docutils literal notranslate">
        <span class="pre">
         integrate
        </span>
       </code>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#constant-function-f-x-c">
         Constant function
         <span class="math notranslate nohighlight">
          \(f(x)=c\)
         </span>
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#line-g-x-x">
         Line
         <span class="math notranslate nohighlight">
          \(g(x)=x\)
         </span>
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculations-with-random-variables">
     Calculations with random variables
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-1-mean-and-variance-of-the-uniform-distribution">
       Example 1: mean and variance of the uniform distribution
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#mean">
         Mean
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#variance">
         Variance
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-2-mean-and-variance-of-a-normal-distribution">
       Example 2: mean and variance of a normal distribution
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probability-models">
     Probability models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computer-models-for-random-variables">
     Computer models for random variables
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plotting-the-probability-functions">
       Plotting the probability functions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#properties-of-the-distribution">
       Properties of the distribution
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-probabilities">
       Computing probabilities
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-quantiles">
       Computing quantiles
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#left-tail">
         Left tail
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#right-tail">
         Right tail
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#computing-confidence-intervals">
         Computing confidence intervals
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#generating-random-observations">
       Generating random observations
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computing-expectations">
       Computing expectations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#discussion">
     Discussion
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#theoretical-calculus-topics">
       Theoretical calculus topics
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#limits">
         Limits
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#derivatives">
         Derivatives
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#optimization-algorithms">
         Optimization algorithms
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#using-scipy-optimization-functions">
         Using SciPy optimization functions
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#riemann-sums">
         Riemann sums
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#fundamental-theorem-of-calculus">
         Fundamental theorem of calculus
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bulk-of-the-distribution">
       Bulk of the distribution
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tails-of-the-distribution">
       Tails of the distribution
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#figures-gen">
   FIGURES GEN
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cut-material">
   CUT MATERIAL
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-probability-calculation">
     Example probability calculation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cumulative-density-function-cdf">
     Cumulative density function (CDF)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-inverse-cdf-function">
     The inverse-CDF function
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#early-attempts-at-expectations-calculations">
       EARLY ATTEMPTS AT EXPECTATIONS CALCULATIONS
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#alt">
       Alt
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="section-2-1-probability-theory">
<h1>Section 2.1 — Probability theory<a class="headerlink" href="#section-2-1-probability-theory" title="Permalink to this headline">¶</a></h1>
<p>This notebook contains all the code examples from <span class="xref myst">Section 2.1 Probability theory</span> in the <strong>No Bullshit Guide to Statistics</strong>.</p>
<p>Topics covered in this notebook:</p>
<ul class="simple">
<li><p>Examples of random variables</p></li>
<li><p>Calculus review</p>
<ul>
<li><p>Math definitions</p></li>
<li><p>Numerical integration using the <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> functions <code class="docutils literal notranslate"><span class="pre">quad</span></code> and <code class="docutils literal notranslate"><span class="pre">trapz</span></code></p></li>
<li><p>Symbolic integration using the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> function <code class="docutils literal notranslate"><span class="pre">integrate</span></code></p></li>
</ul>
</li>
<li><p>Probability calculations</p></li>
<li><p>Probability models for real-world quantities</p></li>
<li><p>Computer models for random variables</p>
<ul>
<li><p>Overview of <code class="docutils literal notranslate"><span class="pre">scipy.stats.distributions</span></code> methods</p></li>
<li><p>Example of calculations</p></li>
</ul>
</li>
<li><p>Discussion</p>
<ul>
<li><p>More calculus topics</p></li>
<li><p>Bulk and tails of the normal distribution</p></li>
<li><p>Interpretations of probability theory</p></li>
</ul>
</li>
</ul>
<div class="section" id="notebook-setup">
<h2>Notebook setup<a class="headerlink" href="#notebook-setup" title="Permalink to this headline">¶</a></h2>
<p>We’ll start by importing the Python modules we’ll need for this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load Python modules</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Figures setup</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span>
    <span class="n">context</span><span class="o">=</span><span class="s2">&quot;paper&quot;</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;colorblind&quot;</span><span class="p">,</span>
    <span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">)},</span>
<span class="p">)</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;

<span class="c1"># # silence annoying warnings</span>
<span class="c1"># import warnings; warnings.filterwarnings(&#39;ignore&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set random seed for repeatability</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="what-is-probability-theory">
<h2>What is probability theory?<a class="headerlink" href="#what-is-probability-theory" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>definition: <strong>probability theory is a language for describing uncertainty, variability, and randomness</strong></p></li>
<li><p>Originally the study of “randomness” and “expectations” started to quantify random events in gambling.</p></li>
<li><p>Later extended to as a general purpose tool to model any process that contains uncertainty:</p>
<ul>
<li><p>random variables = described by probability distribution (CDF, pmf/pdf) modelled as a math function with parameters <span class="math notranslate nohighlight">\(\theta\)</span></p></li>
<li><p>noise = can be modelled as a random variable</p></li>
<li><p>sampling = variations due to random selection of a subset from the population</p></li>
<li><p>beliefs = can be described as probability distributions</p></li>
</ul>
</li>
<li><p>Probability theory is an essential tool for statistics.</p></li>
<li><p>Probability theory is also a foundational subject that used in physics, machine learning, biology, optimization, algorithms, etc. (side note: in terms of usefulness, I’d say probability theory is up there with linear algebra—you need to know this shit!)</p></li>
</ul>
</div>
<div class="section" id="why-do-we-need-probability-theory-in-statistics">
<h2>Why do we need probability theory in statistics?<a class="headerlink" href="#why-do-we-need-probability-theory-in-statistics" title="Permalink to this headline">¶</a></h2>
<p>Probability theory provides us with some essential tools needed for statistics:</p>
<ul class="simple">
<li><p>modelling: describe a population as a probability distribution</p></li>
<li><p>sampling distributions: distributions obtained for random samples from a population</p></li>
</ul>
<p>Additionally, artificially introduced randomness is the basis for two of the most important statistics “kung fu” techniques:</p>
<ul class="simple">
<li><p><strong>random selection</strong> = if you collect a sample of size n randomly selected from a population, then compute statistics from the sample, you can then make inferences about the whole population.</p></li>
<li><p><strong>random assignment</strong> = create two roughly equivalent groups by randomly assigning participants into group A or group B. This random split is the basis for a statistical experiment that compares an intervention group and a control group. Given the participants were randomly assigned to the two groups, we can hope they are roughly equally distributed on all dimensions (similar distribution of all confounding variables), so that any differences observed between groups can be attributed to the intervention. Calculating the difference statistic intervention-control give an estimate of the effect size of this intervention.</p></li>
</ul>
</div>
<div class="section" id="definitions">
<h2>Definitions<a class="headerlink" href="#definitions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="random-variables">
<h3>Random variables<a class="headerlink" href="#random-variables" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><em>random variable</em> <span class="math notranslate nohighlight">\(X\)</span>:
a quantity that can take on different values.</p></li>
<li><p><strong>outcome</strong>: a particular value <span class="math notranslate nohighlight">\(\{X = x\}\)</span> or range of values <span class="math notranslate nohighlight">\(\{a \leq X \leq b\}\)</span> that can occur
as a result of observing the random variable <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
<li><p><strong>sample space</strong> <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>: describes the set of all possible outcomes of the random variable.</p></li>
<li><p><strong><span class="math notranslate nohighlight">\(f_X\)</span></strong>: the \emph{probability distribution function}
is a function that assigns probabilities to the different outcome in the sample space of a random variable.
The probability distribution function of the random variable <span class="math notranslate nohighlight">\(X\)</span>
is a function of the form <span class="math notranslate nohighlight">\(f_X: \mathcal{X} \to \mathbb{R}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(F_X\)</span>:
the \emph{cumulative distribution function} (CDF) tells us the probability of an outcome
less than or equal to a given value: <span class="math notranslate nohighlight">\(F_X(b) = Pr(\{ X \leq b \})\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(F_X^{-1}\)</span>:
the inverse cumulative distribution function computes contains the information
about the quantiles of the probability distribution.
The value <span class="math notranslate nohighlight">\(F_X^{-1}(q)=x_q\)</span> tells how far you need to go in the sample space
so that the event <span class="math notranslate nohighlight">\(\{ X \leq x_q \}\)</span> contains a proportion <span class="math notranslate nohighlight">\(q\)</span> of the total probability:
<span class="math notranslate nohighlight">\(\Pr(\{ X \leq x_q \})=q\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbb{E}_X[w]\)</span>:
the \emph{expected value} of the function <span class="math notranslate nohighlight">\(w(X)\)</span>
computes the average value of <span class="math notranslate nohighlight">\(w(X)\)</span> computed for all the possible values of the random variable <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
</ul>
<div class="section" id="example-1-uniform-distribution">
<h4>Example 1: Uniform distribution<a class="headerlink" href="#example-1-uniform-distribution" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Continuous_uniform_distribution">uniform distribution</a> <span class="math notranslate nohighlight">\(\mathcal{U}(0,1)\)</span> is described by the following probability density function:
$<span class="math notranslate nohighlight">\(
  p_U(u) =
  \begin{cases}
      1 &amp; \mathrm{for}\ 0 \le u \le 1, \\
      0 &amp; \mathrm{for}\ u&lt;0\ \mathrm{or}\ u&gt;1.
  \end{cases}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>U<span class="math notranslate nohighlight">\( is the name of the random variable and \)</span>u$ are particular values it can take on.</p>
<p>The above equation describes tells you how likely it is to observe <span class="math notranslate nohighlight">\(\{U=u\}\)</span>.
For a uniform distribution <span class="math notranslate nohighlight">\(\mathcal{U}(0,1)\)</span>, each <span class="math notranslate nohighlight">\(u\)</span> between 0 and 1 is equally likely to occur,
and values of <span class="math notranslate nohighlight">\(u\)</span> outside this range have zero probability of occurring.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">uniform</span>

<span class="n">rvU</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="n">quad</span><span class="p">(</span><span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-2-normal-distribution">
<h4>Example 2: Normal distribution<a class="headerlink" href="#example-2-normal-distribution" title="Permalink to this headline">¶</a></h4>
<p>A random variable <span class="math notranslate nohighlight">\(N\)</span> with a <a class="reference external" href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a>
<span class="math notranslate nohighlight">\(\mathcal{N}(\mu,\sigma)\)</span> is described by the probability density function:
$<span class="math notranslate nohighlight">\( \Large
    p_N(n) = \tfrac{1}{\sigma\sqrt{2\pi}} e^{\small -\tfrac{(n-\mu)^2}{2\sigma^2}}.
\)</span>$</p>
<p>The mean <span class="math notranslate nohighlight">\(\mu\)</span> (the Greek letter <em>mu</em>) and the standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> (the Greek letter <em>sigma</em>) are called the parameters of the distribution.</p>
<p>The math notation <span class="math notranslate nohighlight">\(\mathcal{N}(\mu, \sigma)\)</span> is used to describe the whole family of normal probability distributions,
and <span class="math notranslate nohighlight">\(N \sim \mathcal{N}(1000, 100)\)</span> is a particular instance of the distribution with mean <span class="math notranslate nohighlight">\(\mu = 1000\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma = 100\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">rvN</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">quad</span><span class="p">(</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">900</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13590512198327784
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-3-coin-flip">
<h4>Example 3: Coin flip<a class="headerlink" href="#example-3-coin-flip" title="Permalink to this headline">¶</a></h4>
<p>Consider the random variable <span class="math notranslate nohighlight">\(C\)</span> that describes the outcome of a coin flip for a balanced (fair) coin.
The sample space for the random variable <span class="math notranslate nohighlight">\(C\)</span> is <span class="math notranslate nohighlight">\(\{\texttt{heads}, \texttt{tails}\}\)</span>.</p>
<p>The probability mass function is
$<span class="math notranslate nohighlight">\(
    f_C(\texttt{heads}) = 0.5
    \quad
    \textrm{and}
    \quad
    f_C(\texttt{tails}) = 0.5.
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="n">rvC</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">rvC</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1, 0, 0, 0, 1, 0, 0, 0, 1])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-4-rolling-a-six-sided-die">
<h4>Example 4: Rolling a six-sided die<a class="headerlink" href="#example-4-rolling-a-six-sided-die" title="Permalink to this headline">¶</a></h4>
<p>The random outcome that occurs when we roll a six-sided die can be described as a random variable <span class="math notranslate nohighlight">\(D\)</span>
which has the sample space <span class="math notranslate nohighlight">\(\{1, 2, 3, 4, 5, 6\}\)</span>.
If we assume the die is fair,
then each of the outcomes will have equal weight,
so the probability mass function <span class="math notranslate nohighlight">\(f_D\)</span> has the following values:</p>
<div class="math notranslate nohighlight">
\[
    f_D(1)\!=\!\tfrac{1}{6},
    \ 
    f_D(2)\!=\!\tfrac{1}{6},
    \ 
    f_D(3)\!=\!\tfrac{1}{6},
    \ 
    f_D(4)\!=\!\tfrac{1}{6},
    \ 
    f_D(5)\!=\!\tfrac{1}{6},
    \ 
    f_D(6)\!=\!\tfrac{1}{6}.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvD</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">rvD</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 3, 3, 5, 4, 3, 6, 5, 2, 4])
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="calculus-prerequisites">
<h2>Calculus prerequisites<a class="headerlink" href="#calculus-prerequisites" title="Permalink to this headline">¶</a></h2>
<p>(see formulas and definitions in the book)</p>
<div class="section" id="sets">
<h3>Sets<a class="headerlink" href="#sets" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">T</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;S ∪ T =&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;S ∩ T =&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;S \ T =&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>S ∪ T = {1, 2, 3, 4, 5, 6}
S ∩ T = {3}
S \ T = {1, 2}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<p>In Python, we define functions using the <code class="docutils literal notranslate"><span class="pre">def</span></code> keyword.</p>
<p>For example, the code cell below defines the function <span class="math notranslate nohighlight">\(g(x)=x\)</span>,
then evaluate it for the input <span class="math notranslate nohighlight">\(x=4\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the function g that takes input x</span>
<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="c1"># calling the function g on input x=4</span>
<span class="n">g</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<div class="section" id="plotting-the-graph-of-the-function">
<h4>Plotting the graph of the function<a class="headerlink" href="#plotting-the-graph-of-the-function" title="Permalink to this headline">¶</a></h4>
<p>The graph of the function <span class="math notranslate nohighlight">\(g(x)\)</span> is obtained by plotting a line that passes through the set of input-output coordinate pairs <span class="math notranslate nohighlight">\((x, g(x))\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>


<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Graph of the function g(x)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/21_prob_theory_33_1.png" src="../_images/21_prob_theory_33_1.png" />
</div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">linspace(0,10,100)</span></code> creates an array of <code class="docutils literal notranslate"><span class="pre">100</span></code> points in the interval <span class="math notranslate nohighlight">\([0,10]\)</span>.
We store this sequence of inputs into the variable <code class="docutils literal notranslate"><span class="pre">xs</span></code>.
Next, we computer the output value <span class="math notranslate nohighlight">\(y = g(x)\)</span> for each of the inputs in the array <code class="docutils literal notranslate"><span class="pre">xs</span></code>,
and store the result in the array <code class="docutils literal notranslate"><span class="pre">ys</span></code>.
Finally, we use the function <code class="docutils literal notranslate"><span class="pre">sns.lineplot()</span></code> to generate the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import matplotlib.pyplot as plt</span>
<span class="c1"># filename = &quot;figures/graph_of_function_g_eq_x.pdf&quot;</span>

<span class="c1"># with plt.rc_context({&quot;figure.figsize&quot;:(4,4)}):</span>
<span class="c1">#     ax = sns.lineplot(x=xs, y=ys, label=&quot;Graph of the function g(x)&quot;)</span>
<span class="c1">#     ax.figure.tight_layout()</span>
<span class="c1">#     ax.set_xlabel(&#39;x&#39;)</span>
<span class="c1">#     ax.set_ylabel(&#39;g(x)&#39;)</span>
<span class="c1">#     ax.figure.savefig(filename, dpi=300, bbox_inches=&quot;tight&quot;, pad_inches=0)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span>

<span class="n">log</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.3862943611198906
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="maybe-cut">
<h4>MAYBE CUT<a class="headerlink" href="#maybe-cut" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># define normally distributed random variable with 𝜇=1000 and 𝜎=100</span>
<span class="n">rvN</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">fNs</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">fNs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Probability density function $f_N$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/21_prob_theory_39_1.png" src="../_images/21_prob_theory_39_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import matplotlib.pyplot as plt</span>
<span class="c1"># filename = &quot;figures/graph_of_pdf_of_rvN.pdf&quot;</span>

<span class="c1"># with plt.rc_context({&quot;figure.figsize&quot;:(7,3)}):</span>
<span class="c1">#     x = np.linspace(0, 2000, 10000)</span>
<span class="c1">#     fN = rvN.pdf(x)</span>
<span class="c1">#     ax = sns.lineplot(x=x, y=fN)</span>
<span class="c1">#     ax.figure.tight_layout()</span>
<span class="c1">#     ax.set_title(&quot;Probability density function for the distribution $\mathcal{N}(1000,100)$&quot;)</span>
<span class="c1">#     ax.set_xlabel(&#39;$x$&#39;)</span>
<span class="c1">#     ax.set_ylabel(&#39;$f_N(x)$&#39;)</span>
<span class="c1">#     ax.figure.savefig(filename, dpi=300, bbox_inches=&quot;tight&quot;, pad_inches=0)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="computing-integrals-geometrically">
<h3>Computing integrals geometrically<a class="headerlink" href="#computing-integrals-geometrically" title="Permalink to this headline">¶</a></h3>
<p><img alt="simple_integral_one_tikz-0.png" src="notebooks/attachment:e59d1b50-81f5-49ce-8159-4c7cc3550b62.png" /></p>
<p>FIG 1: integral under <span class="math notranslate nohighlight">\(f(x)  = 3\)</span></p>
<p>TODO: include fig and eqns</p>
<p>FIG 2: integral under <span class="math notranslate nohighlight">\(g(x) = x\)</span></p>
<p><img alt="simple_integral_two_tikz-0.png" src="notebooks/attachment:ab82905d-7508-434c-a865-722d7f7eb839.png" /></p>
<p>G_0(b) = A_g(0,b) = \int_0^b g(x) ; dx = \tfrac{1}{2} ( b\times b ) = \tfrac{1}{2}b^2.</p>
</div>
<div class="section" id="computing-integrals-numerically-using-scipy-integrate-methods">
<h3>Computing integrals numerically using SciPy <code class="docutils literal notranslate"><span class="pre">integrate</span></code> methods<a class="headerlink" href="#computing-integrals-numerically-using-scipy-integrate-methods" title="Permalink to this headline">¶</a></h3>
<p>There are numerous ways to compute integrals in Python.
Computing integrals “numerically” means we’re splitting the region of integration into thousands or millions of sub-regions, computing the areas of these sub-regions, and adding up the result.</p>
<p>We’ll now show some examples using two of the functions form the module <code class="docutils literal notranslate"><span class="pre">sympy.integrate</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">quad(f,a,b)</span></code>: computing integral using quadrature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trapz(ys,xs)</span></code>: computing integral using trapezoid approximation</p></li>
</ul>
<p>TODO: show vizualization of quad and trapz methods (split into rectangles; useful also for Riemann sum)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">trapz</span><span class="p">,</span> <span class="n">quad</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the constant function f(x) = c</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">c</span>

<span class="c1"># call the funtion f with input x=333</span>
<span class="n">f</span><span class="p">(</span><span class="mi">333</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10.0, 1.1102230246251565e-13)
</pre></div>
</div>
</div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">quad</span></code> returns two numbers as output: the value of the integral and a precision parameter.
In output of the code, tells us the value of the integral is <span class="math notranslate nohighlight">\(\int_0^5 2\;dx\)</span> is <code class="docutils literal notranslate"><span class="pre">10.0</span></code> and guarantees the accuracy of this value up to an error of <span class="math notranslate nohighlight">\(10^{-13}\)</span>.</p>
<p>Since we’re usually only interested in the value of the integral, we often select the first output of <code class="docutils literal notranslate"><span class="pre">quad</span></code> so you’ll see the code like <code class="docutils literal notranslate"><span class="pre">quad(...)[0]</span></code> in all the code examples below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the function g(x) = mx (line with slope 1)</span>
<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="c1"># call the funtion f with input x=10</span>
<span class="n">g</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.5
</pre></div>
</div>
</div>
</div>
<p>Let’s now use another approach based on the trapezoid approximation.</p>
<p>We must build array of inputs… outputs …</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>

<span class="n">trapz</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12.5
</pre></div>
</div>
</div>
</div>
<p>As a preview of calculations with probability distributions…</p>
</div>
<div class="section" id="maybe-cut-or-restructure-because-used-before-defined">
<h3>MAYBE CUT OR RESTRUCTURE BECAUSE USED-BEFORE-DEFINED<a class="headerlink" href="#maybe-cut-or-restructure-because-used-before-defined" title="Permalink to this headline">¶</a></h3>
<div class="section" id="uniform">
<h4>Uniform<a class="headerlink" href="#uniform" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">uniform</span>

<span class="n">rvU</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">quad</span><span class="p">(</span><span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9999999999999999
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="normal">
<h4>Normal<a class="headerlink" href="#normal" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="n">rvN</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">quad</span><span class="p">(</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0000000000000002
</pre></div>
</div>
</div>
</div>
<p>We’re using limits of integration 0 and 2000 because that function is practically zero outside this range, and function <code class="docutils literal notranslate"><span class="pre">quad</span></code> <a class="reference external" href="https://stackoverflow.com/questions/63673369/while-using-scipy-integrate-quad-increasing-bound-of-a-positive-function-decrea">needs</a> finite limits of integration to work properly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quad</span><span class="p">(</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">900</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13590512198327784
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">yN</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">trapz</span><span class="p">(</span><span class="n">yN</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13590513317137634
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="computing-integrals-symbolically-using-sympy-integrate">
<h3>Computing integrals symbolically using SymPy <code class="docutils literal notranslate"><span class="pre">integrate</span></code><a class="headerlink" href="#computing-integrals-symbolically-using-sympy-integrate" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">integrate</span>

<span class="c1"># define symbolic variables</span>
<span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x a b c&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>TODO: explain what above lines</p>
<div class="section" id="constant-function-f-x-c">
<h4>Constant function <span class="math notranslate nohighlight">\(f(x)=c\)</span><a class="headerlink" href="#constant-function-f-x-c" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fx</span> <span class="o">=</span> <span class="n">c</span>
<span class="n">fx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>  <span class="c1"># = A_f(a,b)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - a c + b c\]</div>
</div>
</div>
<p>The answer <span class="math notranslate nohighlight">\(c\cdot (b-a)\)</span> is the general expression for calculating the area under <span class="math notranslate nohighlight">\(f(x)=c\)</span>,
for between any starting point <span class="math notranslate nohighlight">\(x=a\)</span> and end point <span class="math notranslate nohighlight">\(x=b\)</span>.
Geometrically, this is just a height-times-width formula for the area of a rectangle.</p>
<p>To compute the specific integral between <span class="math notranslate nohighlight">\(a=0\)</span> and <span class="math notranslate nohighlight">\(b=5\)</span> under <span class="math notranslate nohighlight">\(f(x)=2\)</span>,
we use the <code class="docutils literal notranslate"><span class="pre">subs</span></code> (substitute) method,
passing in a Python dictionary of the values we want to “plug” into the general expression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">c</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 10\]</div>
</div>
</div>
<p>The integral function <span class="math notranslate nohighlight">\(F_0(b) = \int_0^b f(x) dx\)</span> is obtained as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>  <span class="c1"># = F_0(b)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle b c\]</div>
</div>
</div>
</div>
<div class="section" id="line-g-x-x">
<h4>Line <span class="math notranslate nohighlight">\(g(x)=x\)</span><a class="headerlink" href="#line-g-x-x" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gx</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">x</span>
<span class="n">gx</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle x\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>  <span class="c1"># = A_g(a,b)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - \frac{a^{2}}{2} + \frac{b^{2}}{2}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{25}{2}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # ALT.</span>
<span class="c1"># integrate(gx, (x,a,b)).subs(a,0).subs(b,5)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">m</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [36],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">integrate</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">m</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;m&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>The integral function <span class="math notranslate nohighlight">\(G_0(b) = \int_0^b g(x) dx\)</span> is obtained as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">integrate</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>  <span class="c1"># = G_0(b)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{b^{2}}{2}\]</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="calculations-with-random-variables">
<h2>Calculations with random variables<a class="headerlink" href="#calculations-with-random-variables" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-mean-and-variance-of-the-uniform-distribution">
<h3>Example 1: mean and variance of the uniform distribution<a class="headerlink" href="#example-1-mean-and-variance-of-the-uniform-distribution" title="Permalink to this headline">¶</a></h3>
<div class="section" id="mean">
<h4>Mean<a class="headerlink" href="#mean" title="Permalink to this headline">¶</a></h4>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \mu_U = \mathbb{E}_U[U] 
        &amp;=	\int_{-\infty}^{\infty}	u f_U(u) \; du		\\
        &amp;=	\int_0^1 u f_U(u) \; du				\\
        &amp;=	\int_0^1 u \cdot 1 \; du	= 	\tfrac{1}{2}.
\end{align*}\]</div>
</div>
<div class="section" id="variance">
<h4>Variance<a class="headerlink" href="#variance" title="Permalink to this headline">¶</a></h4>
<p>The formula for the variance is
$<span class="math notranslate nohighlight">\(
    \sigma_U^2
        = \mathbb{E}_U\left[ (U-\mu_U)^2 \right]
        = \int_0^1 (u- \tfrac{1}{2})^2 \cdot f_U(u) \; du.
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">integrate</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="n">integrate</span><span class="p">(</span> <span class="p">(</span><span class="n">u</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 0.0833333333333333\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.0833333333333333</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2886751345948128
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="example-2-mean-and-variance-of-a-normal-distribution">
<h3>Example 2: mean and variance of a normal distribution<a class="headerlink" href="#example-2-mean-and-variance-of-a-normal-distribution" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[
    p_N(n)
      = \tfrac{1}{\sigma\sqrt{2\pi}} e^{-\tfrac{(n-\mu)^2}{2\sigma^2}}
      = \tfrac{1}{100\sqrt{2\pi}} e^{-\tfrac{(n-1000)^2}{2\cdot100^2}}.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">100</span>

<span class="k">def</span> <span class="nf">fN</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">C</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="k">def</span> <span class="nf">n_times_fN</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fN</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">muN</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">n_times_fN</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">muN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">n_minus_mu_sq_times_fN</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">muN</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fN</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">sigma_sq</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">n_minus_mu_sq_times_fN</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sigmaN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma_sq</span><span class="p">)</span>
<span class="n">sigmaN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100.00000000000001
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="probability-models">
<h2>Probability models<a class="headerlink" href="#probability-models" title="Permalink to this headline">¶</a></h2>
<p>In probability theory, we model data as instances of a <strong>random variable</strong> <span class="math notranslate nohighlight">\(X\)</span> described by a <strong>probability distribution</strong> <span class="math notranslate nohighlight">\(f_X\)</span> (a math function) with particular parameters (usually denoted with Greek letters like <span class="math notranslate nohighlight">\(\theta\)</span>, <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(\sigma\)</span>, etc.).</p>
<p>Multiple different ways to specify and interact with probability distributions:</p>
<ul class="simple">
<li><p>exact math model function (CDF from which we can extract pdf density function or pmf mass function). Math models allow us the most options: <code class="docutils literal notranslate"><span class="pre">rvs</span></code>, <code class="docutils literal notranslate"><span class="pre">cdf</span></code>, <code class="docutils literal notranslate"><span class="pre">pdf/pmf</span></code>, and stats like <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">median</span></code>, <code class="docutils literal notranslate"><span class="pre">var/std</span></code>, <code class="docutils literal notranslate"><span class="pre">quartiles</span></code>.</p></li>
<li><p>random draws form a generative process</p></li>
<li><p>random draws from a real world process</p></li>
<li><p>data for an entire population (census)</p></li>
<li><p>sample data from a population</p></li>
<li><p>synthetic data obtained by resampling</p>
<ul>
<li><p>bootstrap estimation for any distribution</p></li>
<li><p>permutation test for no-difference-between-groups hypotheses</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="computer-models-for-random-variables">
<h2>Computer models for random variables<a class="headerlink" href="#computer-models-for-random-variables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;model&gt;</span></code>: the family of probability distributions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;params&gt;</span></code>: parameters of the model—specific value of the control knobs we choose in the general family of distributions to create a particular distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;model&gt;(&lt;params&gt;)</span></code>: a particular instance of probability model created by choosing a model family <code class="docutils literal notranslate"><span class="pre">&lt;model&gt;</span></code> and the model parameters <code class="docutils literal notranslate"><span class="pre">&lt;params&gt;</span></code>.</p>
<ul>
<li><p>example 1: uniform family of distribution <span class="math notranslate nohighlight">\(\mathcal{U}(\alpha,\beta)\)</span> with parameters <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>.</p></li>
<li><p>example 2: normal family of distribution <span class="math notranslate nohighlight">\(\mathcal{N}(\mu,\sigma)\)</span> with parameters <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>.</p></li>
</ul>
</li>
<li><p><span class="math notranslate nohighlight">\(\sim\)</span>: math shorthand symbol that stands for “is distributed according to.”
For example <span class="math notranslate nohighlight">\(X \sim \texttt{model}(\theta)\)</span> means the random variable <span class="math notranslate nohighlight">\(X\)</span>
is distributed according to model instance <span class="math notranslate nohighlight">\(\texttt{model}\)</span> and parameters <span class="math notranslate nohighlight">\(\theta\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">norm</span>

<span class="c1"># create a normal random variable with mean 1000 and std 100</span>
<span class="n">rvN</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">rvN</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>scipy.stats._distn_infrastructure.rv_frozen
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## see all attributes and methods:</span>
<span class="c1"># [attr for attr in dir(rvN) if &quot;__&quot; not in attr] </span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="plotting-the-probability-functions">
<h3>Plotting the probability functions<a class="headerlink" href="#plotting-the-probability-functions" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">fNs</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">fNs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pdf of $N$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/21_prob_theory_111_1.png" src="../_images/21_prob_theory_111_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import matplotlib.pyplot as plt</span>
<span class="c1"># filename = &quot;figures/plot_of_pdf_of_rvN.pdf&quot;</span>

<span class="c1"># with plt.rc_context({&quot;figure.figsize&quot;:(7,3)}):</span>
<span class="c1">#     ns = np.linspace(0, 2000, 10000)</span>
<span class="c1">#     fNs = rvN.pdf(ns)</span>
<span class="c1">#     ax = sns.lineplot(x=ns, y=fNs, label=&quot;pdf of $N$&quot;)</span>
<span class="c1">#     ax.figure.tight_layout()</span>
<span class="c1">#     ax.figure.savefig(filename, dpi=300, bbox_inches=&quot;tight&quot;, pad_inches=0)</span>
</pre></div>
</div>
</div>
</div>
<p>The cumulative distribution is the integral of the probability density function:
$<span class="math notranslate nohighlight">\(
   F_N(b) = \textrm{Pr}(N \leq b) = \int_{-\infty}^b f_N(n) \, dn
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">FNs</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">ns</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">FNs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CDF of $N$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/21_prob_theory_114_1.png" src="../_images/21_prob_theory_114_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import matplotlib.pyplot as plt</span>
<span class="c1"># filename = &quot;figures/plot_of_CDF_of_rvN.pdf&quot;</span>

<span class="c1"># with plt.rc_context({&quot;figure.figsize&quot;:(7,3)}):</span>
<span class="c1">#     ns = np.linspace(0, 2000, 10000)</span>
<span class="c1">#     FNs = rvN.cdf(ns)</span>
<span class="c1">#     ax = sns.lineplot(x=ns, y=FNs, label=&quot;CDF of $N$&quot;)</span>
<span class="c1">#     ax.figure.tight_layout()</span>
<span class="c1">#     ax.figure.savefig(filename, dpi=300, bbox_inches=&quot;tight&quot;, pad_inches=0)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="properties-of-the-distribution">
<h3>Properties of the distribution<a class="headerlink" href="#properties-of-the-distribution" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10000.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">rvN</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="p">)</span>  <span class="c1"># = rvN.std()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-inf, inf)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computing-probabilities">
<h3>Computing probabilities<a class="headerlink" href="#computing-probabilities" title="Permalink to this headline">¶</a></h3>
<p>Suppose you want to compute the probability of the outcome <span class="math notranslate nohighlight">\(\{ a \leq N \leq b \}\)</span>
for the random variable <span class="math notranslate nohighlight">\(N\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pr({800 &lt; N &lt; 1200}) = integral of f_N between 800 and 1200</span>
<span class="n">quad</span><span class="p">(</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9544997361036417
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pr({800 &lt; N &lt; 1200}) = F_N(1200) - F_N(800)</span>
<span class="n">rvN</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">1200</span><span class="p">)</span> <span class="o">-</span> <span class="n">rvN</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9544997361036416
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computing-quantiles">
<h3>Computing quantiles<a class="headerlink" href="#computing-quantiles" title="Permalink to this headline">¶</a></h3>
<p>The inverse question is to find the interval <span class="math notranslate nohighlight">\((-\infty, n_q]\)</span> that contains proportion <span class="math notranslate nohighlight">\(q\)</span> of the total probability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first quartile</span>
<span class="n">rvN</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>932.5510249803918
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># verify that Pr({N&lt;932.5510249803918)}) == 0.25</span>
<span class="n">rvN</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">932.5510249803918</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.25
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># second quartile == median</span>
<span class="n">rvN</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1000.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># third quartile</span>
<span class="n">rvN</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1067.4489750196083
</pre></div>
</div>
</div>
</div>
<div class="section" id="left-tail">
<h4>Left tail<a class="headerlink" href="#left-tail" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>835.5146373048527
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="right-tail">
<h4>Right tail<a class="headerlink" href="#right-tail" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1164.4853626951472
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computing-confidence-intervals">
<h4>Computing confidence intervals<a class="headerlink" href="#computing-confidence-intervals" title="Permalink to this headline">¶</a></h4>
<p>To compute a 90% confidence interval for the random variable <span class="math notranslate nohighlight">\(N\)</span>,
we can use the <code class="docutils literal notranslate"><span class="pre">rvN.interval()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.90</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(835.5146373048527, 1164.4853626951472)
</pre></div>
</div>
</div>
</div>
<p>Note the method <code class="docutils literal notranslate"><span class="pre">rvN.interval(0.90)</span></code> is just a shortcut for computing <code class="docutils literal notranslate"><span class="pre">(rvN.ppf(0.05),rvN.ppf(0.95))</span></code>.</p>
</div>
</div>
<div class="section" id="generating-random-observations">
<h3>Generating random observations<a class="headerlink" href="#generating-random-observations" title="Permalink to this headline">¶</a></h3>
<p>Let’s say you want to generate <span class="math notranslate nohighlight">\(n=10\)</span> observations from the random variable <span class="math notranslate nohighlight">\(N\)</span>.
You can do this by calling the method <code class="docutils literal notranslate"><span class="pre">rvN.rvs(n)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1178.86284734, 1043.65098505, 1009.64974681,  813.65072966,
        972.26117975,  964.52410207,  991.72585185,  937.29993232,
        995.6181831 ,  952.27819696])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ns_mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
<span class="n">ns_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>985.9521754922469
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computing-expectations">
<h3>Computing expectations<a class="headerlink" href="#computing-expectations" title="Permalink to this headline">¶</a></h3>
<p>Suppose the distributor accepts only bottles contain between 800 ml and 1200 ml,
and you’ll receive a receive payment of <span class="math notranslate nohighlight">\(\$2\)</span> for each bottle.
Bottles outside that range get rejected and you don’t get paid for them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">payment</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">800</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1200</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get paid if in spec</span>
<span class="n">payment</span><span class="p">(</span><span class="mi">1050</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># don&#39;t get paid if out of spec</span>
<span class="n">payment</span><span class="p">(</span><span class="mi">1250</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">payment</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ub</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.9089994722069916
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="p">[</span><span class="n">payment</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">500</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;payment(x)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/21_prob_theory_152_1.png" src="../_images/21_prob_theory_152_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="theoretical-calculus-topics">
<h3>Theoretical calculus topics<a class="headerlink" href="#theoretical-calculus-topics" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span>

<span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x a b i m n&quot;</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle x\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expr</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">x</span>
<span class="n">expr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle b + m x\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">srepr</span>

<span class="n">srepr</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;Add(Symbol(&#39;b&#39;), Mul(Symbol(&#39;m&#39;), Symbol(&#39;x&#39;)))&quot;
</pre></div>
</div>
</div>
</div>
<div class="section" id="limits">
<h4>Limits<a class="headerlink" href="#limits" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">limit</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">summation</span>

<span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="n">n</span>

<span class="n">limit</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 0\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summation</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle - a + b\]</div>
</div>
</div>
</div>
<div class="section" id="derivatives">
<h4>Derivatives<a class="headerlink" href="#derivatives" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">diff</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">x</span>

<span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle m\]</div>
</div>
</div>
<p>The derivative function of <span class="math notranslate nohighlight">\(f(x) = mx +b\)</span> is <span class="math notranslate nohighlight">\(f'(x)=m\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">c</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle c x\]</div>
</div>
</div>
<p>The derivative function of <span class="math notranslate nohighlight">\(f(x) = \frac{c}{2}x^2\)</span> is <span class="math notranslate nohighlight">\(f'(x)=cx\)</span>.</p>
</div>
<div class="section" id="optimization-algorithms">
<h4>Optimization algorithms<a class="headerlink" href="#optimization-algorithms" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">derivative_descent</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-11</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the minimum of SymPy expression `f` using</span>
<span class="sd">    the gradient descent algorithm in one dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_i</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="c1"># print(&#39;current&#39;, x_i, delta)</span>
        <span class="n">df_at_x_i</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">x</span><span class="p">:</span><span class="n">x_i</span><span class="p">})</span>
        <span class="n">x_next</span> <span class="o">=</span> <span class="n">x_i</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="n">df_at_x_i</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x_next</span> <span class="o">-</span> <span class="n">x_i</span><span class="p">)</span>
        <span class="n">x_i</span> <span class="o">=</span> <span class="n">x_next</span>
    <span class="k">return</span> <span class="n">x_i</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s find the minimum value of the function <span class="math notranslate nohighlight">\(f(x) = (x-5)^2\)</span> using the <code class="docutils literal notranslate"><span class="pre">derivative_descent</span></code> algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">argmin_f</span> <span class="o">=</span> <span class="n">derivative_descent</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">argmin_f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle 4.99999999951256\]</div>
</div>
</div>
<p>The solution is roughly accurate to roughly <code class="docutils literal notranslate"><span class="pre">tol</span></code>*10 = <code class="docutils literal notranslate"><span class="pre">1e-10</span></code>  decimals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">float</span><span class="p">(</span><span class="n">argmin_f</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-4.874394221587863e-10
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="using-scipy-optimization-functions">
<h4>Using SciPy optimization functions<a class="headerlink" href="#using-scipy-optimization-functions" title="Permalink to this headline">¶</a></h4>
<p>Let’s solve the same optimization problem using the function <code class="docutils literal notranslate"><span class="pre">minimize</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">res</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># = argmin f(x)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.99999997455944
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="riemann-sums">
<h4>Riemann sums<a class="headerlink" href="#riemann-sums" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="fundamental-theorem-of-calculus">
<h4>Fundamental theorem of calculus<a class="headerlink" href="#fundamental-theorem-of-calculus" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">diff</span><span class="p">,</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">log</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sin</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle x^{2} + e^{x} + \log{\left(x \right)} + \sin{\left(x \right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">F</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">F</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{x^{3}}{3} + x \log{\left(x \right)} - x + e^{x} - \cos{\left(x \right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle x^{2} + e^{x} + \log{\left(x \right)} + \sin{\left(x \right)}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">==</span> <span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="bulk-of-the-distribution">
<h3>Bulk of the distribution<a class="headerlink" href="#bulk-of-the-distribution" title="Permalink to this headline">¶</a></h3>
<p>How much of the total probability “weight” lies within <span class="math notranslate nohighlight">\(k\)</span> standard deviations of the mean?</p>
<div class="math notranslate nohighlight">
\[
\textrm{Pr}(\mu_N - k\sigma_N \leq N \leq \mu_N + k\sigma_N) \ = \ p_k.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="n">rvN</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>    <span class="c1"># mean of the random variable</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># standard deviaiton of the random variable</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
    <span class="n">I_k</span> <span class="o">=</span> <span class="p">[</span><span class="n">mu</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">sigma</span><span class="p">]</span>
    <span class="n">p_k</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="o">*</span><span class="n">I_k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> = Pr( N in </span><span class="si">{</span><span class="n">I_k</span><span class="si">}</span><span class="s2"> ) = </span><span class="si">{</span><span class="n">p_k</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p_1 = Pr( N in [900.0, 1100.0] ) = 0.683
p_2 = Pr( N in [800.0, 1200.0] ) = 0.954
p_3 = Pr( N in [700.0, 1300.0] ) = 0.997
</pre></div>
</div>
</div>
</div>
<p>The code below highlights the interval <span class="math notranslate nohighlight">\(I_k\)</span> and computes the probability <span class="math notranslate nohighlight">\(p_k\)</span>.
Change the value of <span class="math notranslate nohighlight">\(k\)</span> to get different plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">plot_helpers</span> <span class="kn">import</span> <span class="n">calc_prob_and_plot</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>              <span class="c1"># number of standard deviations around the mean</span>

<span class="c1"># values of x in the interval 𝜇 ± k𝜎 = [𝜇-k𝜎, 𝜇+k𝜎]</span>
<span class="n">I_k</span> <span class="o">=</span> <span class="p">[</span><span class="n">mu</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">sigma</span><span class="p">]</span>
<span class="n">p_k</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">calc_prob_and_plot</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="o">*</span><span class="n">I_k</span><span class="p">)</span>
<span class="n">p_k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9544997361036417
</pre></div>
</div>
<img alt="../_images/21_prob_theory_199_1.png" src="../_images/21_prob_theory_199_1.png" />
</div>
</div>
</div>
<div class="section" id="tails-of-the-distribution">
<h3>Tails of the distribution<a class="headerlink" href="#tails-of-the-distribution" title="Permalink to this headline">¶</a></h3>
<p>We’re often interested in tail ends of the distribution, which contain the unlikely events.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>    <span class="c1"># mean of the random variable</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># standard deviaiton of the random variable</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
        <span class="c1"># compute the probability in the left tail (-∞,𝜇-k𝜎]</span>
        <span class="n">x_l</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">sigma</span>
        <span class="n">p_l</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">rvN</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.0000000001</span><span class="p">),</span> <span class="n">x_l</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># compute the probability in the right tail [𝜇+k𝜎,∞)</span>
        <span class="n">x_r</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">sigma</span>
        <span class="n">p_r</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">x_r</span><span class="p">,</span> <span class="n">rvN</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.9999999999</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># add together to get total probability in the tails</span>
        <span class="n">p_tails</span> <span class="o">=</span> <span class="n">p_l</span> <span class="o">+</span> <span class="n">p_r</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pr( N&lt;</span><span class="si">{</span><span class="n">x_l</span><span class="si">}</span><span class="s2"> or N&gt;</span><span class="si">{</span><span class="n">x_r</span><span class="si">}</span><span class="s2"> ) = </span><span class="si">{</span><span class="n">p_tails</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pr( N&lt;900.0 or N&gt;1100.0 ) = 0.3173
Pr( N&lt;800.0 or N&gt;1200.0 ) = 0.0455
Pr( N&lt;700.0 or N&gt;1300.0 ) = 0.0027
</pre></div>
</div>
</div>
</div>
<p>The code below highlights the tails of the distribution and computes the sum of their probability.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">plot_helpers</span> <span class="kn">import</span> <span class="n">calc_prob_and_plot_tails</span>

<span class="n">mu</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>    <span class="c1"># mean of the random variable</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># standard deviaiton of the random variable</span>


<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>              <span class="c1"># number of standard deviations around the mean</span>

<span class="c1"># the distribution&#39;s left tail (-∞,𝜇-k𝜎]</span>
<span class="n">x_l</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">sigma</span>
<span class="c1"># the distribution&#39;s right tail [𝜇+k𝜎,∞)</span>
<span class="n">x_r</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">sigma</span>
<span class="n">p_tails</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">calc_prob_and_plot_tails</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="n">x_l</span><span class="p">,</span> <span class="n">x_r</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1400</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pr( </span><span class="se">{{</span><span class="s2">N&lt;</span><span class="si">{</span><span class="n">x_l</span><span class="si">}</span><span class="se">}}</span><span class="s2"> ∪ </span><span class="se">{{</span><span class="s2">N&gt;</span><span class="si">{</span><span class="n">x_r</span><span class="si">}</span><span class="se">}}</span><span class="s2"> ) = </span><span class="si">{</span><span class="n">p_tails</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pr( {N&lt;800.0} ∪ {N&gt;1200.0} ) = 0.0455
</pre></div>
</div>
<img alt="../_images/21_prob_theory_204_1.png" src="../_images/21_prob_theory_204_1.png" />
</div>
</div>
<p>The above calculations leads us to an important rule of thumb: the values of the 5% tail of the distribution are <span class="math notranslate nohighlight">\(k=2\)</span> standard deviations away from the mean (more precisely, we should use <span class="math notranslate nohighlight">\(k=1.96\)</span> to get exactly 5%).</p>
<p>We’ll use this facts later in STATS to define a <em>cutoff value</em> for events that are unlikely to occur by chance.</p>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="figures-gen">
<h1>FIGURES GEN<a class="headerlink" href="#figures-gen" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">plot_helpers</span> <span class="kn">import</span> <span class="n">plot_pdf_and_cdf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">uniform</span>
<span class="n">rvU</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plot_pdf_and_cdf</span><span class="p">(</span><span class="n">rvU</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">rv_name</span><span class="o">=</span><span class="s2">&quot;U&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 504x288 with 2 Axes&gt;,
 array([&lt;AxesSubplot:title={&#39;center&#39;:&#39;Probability density function&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;Cumulative distribution function&#39;}&gt;],
       dtype=object))
</pre></div>
</div>
<img alt="../_images/21_prob_theory_211_1.png" src="../_images/21_prob_theory_211_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># filename = &quot;figures/uniform_pdf_and_CDF_until_b.pdf&quot;</span>

<span class="c1"># with plt.rc_context({&quot;figure.figsize&quot;:(10,5)}):</span>
<span class="c1">#     fig, axs = plot_pdf_and_cdf(rvU, 0.7, rv_name=&quot;U&quot;)</span>
<span class="c1">#     fig.tight_layout()</span>
<span class="c1">#     fig.savefig(filename, dpi=300, bbox_inches=&quot;tight&quot;, pad_inches=0)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">std</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">rvN</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

<span class="n">plot_pdf_and_cdf</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="mi">1100</span><span class="p">,</span> <span class="n">rv_name</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 504x288 with 2 Axes&gt;,
 array([&lt;AxesSubplot:title={&#39;center&#39;:&#39;Probability density function&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;Cumulative distribution function&#39;}&gt;],
       dtype=object))
</pre></div>
</div>
<img alt="../_images/21_prob_theory_213_1.png" src="../_images/21_prob_theory_213_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># filename = &quot;figures/normal_pdf_and_CDF_until_b.pdf&quot;</span>

<span class="c1"># from scipy.stats.distributions import norm</span>
<span class="c1"># mean = 1000</span>
<span class="c1"># std = 100</span>
<span class="c1"># rvN = norm(mean, std)</span>

<span class="c1"># with plt.rc_context({&quot;figure.figsize&quot;:(10,5)}):</span>
<span class="c1">#     fig, axs = plot_pdf_and_cdf(rvN, 1100, rv_name=&quot;N&quot;)</span>
<span class="c1">#     fig.tight_layout()</span>
<span class="c1">#     fig.savefig(filename, dpi=300, bbox_inches=&quot;tight&quot;, pad_inches=0)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">plot_helpers</span> <span class="kn">import</span> <span class="n">calc_prob_and_plot</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;figures/bulk_of_the_distribution_panel.pdf&quot;</span>

<span class="n">mu</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>    <span class="c1"># mean of the random variable</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># standard deviaiton of the random variable</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">({</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">)}):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">axs</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">bulk_interval1</span> <span class="o">=</span> <span class="p">[</span><span class="n">mu</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span><span class="p">]</span>
    <span class="n">p1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">calc_prob_and_plot</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="o">*</span><span class="n">bulk_interval1</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1400</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span>
                                 <span class="n">title</span><span class="o">=</span><span class="s2">&quot;(a) Pr({$\mu-\sigma \leq N \leq \mu+\sigma$})&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n =&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;interval contains&quot;</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">bulk_interval2</span> <span class="o">=</span> <span class="p">[</span><span class="n">mu</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span><span class="p">]</span>
    <span class="n">p2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">calc_prob_and_plot</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="o">*</span><span class="n">bulk_interval2</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1400</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span>
                                 <span class="n">title</span><span class="o">=</span><span class="s2">&quot;(b) Pr({$\mu-2\sigma \leq N \leq \mu+2\sigma$})&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n =&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;interval contains&quot;</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">bulk_interval3</span> <span class="o">=</span> <span class="p">[</span><span class="n">mu</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span><span class="p">]</span>
    <span class="n">p3</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">calc_prob_and_plot</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="o">*</span><span class="n">bulk_interval3</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1400</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span>
                                 <span class="n">title</span><span class="o">=</span><span class="s2">&quot;(c) Pr({$\mu-3\sigma \leq N \leq \mu+3\sigma$})&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n =&quot;</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;interval contains&quot;</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>n = 1 interval contains 0.6826894921370859
n = 2 interval contains 0.9544997361036417
n = 3 interval contains 0.99730020393674
</pre></div>
</div>
<img alt="../_images/21_prob_theory_218_1.png" src="../_images/21_prob_theory_218_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;figures/tails_of_the_distribution_panel.pdf&quot;</span>


<span class="kn">from</span> <span class="nn">plot_helpers</span> <span class="kn">import</span> <span class="n">calc_prob_and_plot_tails</span>




<span class="n">mu</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>    <span class="c1"># mean of the random variable</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">rvN</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>  <span class="c1"># standard deviaiton of the random variable</span>


<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">({</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">:(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">)}):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">axs</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">x_l</span> <span class="o">=</span> <span class="n">mu</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span>
    <span class="n">x_r</span> <span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span>
    <span class="n">title1</span> <span class="o">=</span> <span class="s2">&quot;(a) Pr( {$N \leq \mu-\sigma$} $\cup$ {$N \geq \mu+\sigma$} )&quot;</span>
    <span class="n">p2</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">calc_prob_and_plot_tails</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="n">x_l</span><span class="p">,</span> <span class="n">x_r</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1400</span><span class="p">],</span>
                                      <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title1</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">x_l</span> <span class="o">=</span> <span class="n">mu</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span>
    <span class="n">x_r</span> <span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span>
    <span class="n">title2</span> <span class="o">=</span> <span class="s2">&quot;(b) Pr( {$N \leq \mu-2\sigma$} $\cup$ {$N \geq \mu+2\sigma$} )&quot;</span>
    <span class="n">p2</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">calc_prob_and_plot_tails</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="n">x_l</span><span class="p">,</span> <span class="n">x_r</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1400</span><span class="p">],</span>
                                      <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title2</span><span class="p">)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">x_l</span> <span class="o">=</span> <span class="n">mu</span><span class="o">-</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span>
    <span class="n">x_r</span> <span class="o">=</span> <span class="n">mu</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="n">sigma</span>
    <span class="n">title3</span> <span class="o">=</span> <span class="s2">&quot;(c) Pr( {$N \leq \mu-3\sigma$} $\cup$ {$N \geq \mu+3\sigma$} )&quot;</span>
    <span class="n">p3</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">calc_prob_and_plot_tails</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="n">x_l</span><span class="p">,</span> <span class="n">x_r</span><span class="p">,</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1400</span><span class="p">],</span>
                                      <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title3</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p1</span><span class="si">=}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p2</span><span class="si">=}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p3</span><span class="si">=}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>p1=0.6826894921370859
p2=0.04550026389615838
p3=0.002699796063060157
</pre></div>
</div>
<img alt="../_images/21_prob_theory_219_1.png" src="../_images/21_prob_theory_219_1.png" />
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="cut-material">
<h1>CUT MATERIAL<a class="headerlink" href="#cut-material" title="Permalink to this headline">¶</a></h1>
<div class="section" id="example-probability-calculation">
<h2>Example probability calculation<a class="headerlink" href="#example-probability-calculation" title="Permalink to this headline">¶</a></h2>
<p>What is the probability of observing a value between 800 and 900.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="c1"># Pr(800 &lt; X &lt; 900) = integral of f_X between 800 and 900</span>
<span class="n">quad</span><span class="p">(</span><span class="n">rvN</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">900</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13590512198327784
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calc_prob_and_plot</span><span class="p">(</span><span class="n">rvN</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.49996832875816705,
 &lt;AxesSubplot:title={&#39;center&#39;:&#39;Probability density for the random variable norm(1000, 100) between 600 and 1000&#39;}&gt;)
</pre></div>
</div>
<img alt="../_images/21_prob_theory_229_1.png" src="../_images/21_prob_theory_229_1.png" />
</div>
</div>
</div>
<div class="section" id="cumulative-density-function-cdf">
<h2>Cumulative density function (CDF)<a class="headerlink" href="#cumulative-density-function-cdf" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pr(800 &lt; X &lt; 900) = F(900) - F(800)</span>
<span class="n">rvN</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span> <span class="o">-</span> <span class="n">rvN</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13590512198327787
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-inverse-cdf-function">
<h2>The inverse-CDF function<a class="headerlink" href="#the-inverse-cdf-function" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1025.33471031358
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvN</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mf">1025.33471031358</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6000000000000001
</pre></div>
</div>
</div>
</div>
<div class="section" id="early-attempts-at-expectations-calculations">
<h3>EARLY ATTEMPTS AT EXPECTATIONS CALCULATIONS<a class="headerlink" href="#early-attempts-at-expectations-calculations" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Rational</span>
<span class="n">integrate</span><span class="p">(</span> <span class="p">(</span><span class="n">u</span><span class="o">-</span><span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \frac{1}{12}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">uniform</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">rvU</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">trapz</span>

<span class="c1"># mean</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">trapz</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
<span class="n">mu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># variance</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="n">trapz</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
<span class="n">sigma2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>666.6670006676678
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rvU</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.08333333333333333
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="alt">
<h3>Alt<a class="headerlink" href="#alt" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats.distributions</span> <span class="kn">import</span> <span class="n">uniform</span>

<span class="n">rvU</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">xpU</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">quad</span><span class="p">(</span><span class="n">xpU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">xpU</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">muX</span> <span class="o">=</span> <span class="n">rvU</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">quad</span><span class="p">(</span><span class="n">xpU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">simpson</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">rvU</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">simpson</span><span class="p">(</span><span class="n">xs</span><span class="o">*</span><span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="n">xs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">rvU</span> <span class="o">=</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">rvU</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>

<span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">dx</span>

<span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">),</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.49949949949949957, 0.5005005005005005)
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "minireference/noBSstatsnotebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Ivan Savov<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>